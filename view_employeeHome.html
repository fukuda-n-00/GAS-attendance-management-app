<!-- åŸºæœ¬çš„ã«ã¯å¾“æ¥­å“¡ç”¨ã®ãƒ›ãƒ¼ãƒ ãƒšãƒ¼ã‚¸ -->
<!-- æ‰“åˆ»ãŒã§ãã‚‹ -->

<!DOCTYPE html>
<html>
  <head>
  <base target="_top">
  <?!= HtmlService.createHtmlOutputFromFile('css').getContent(); ?>
  <title>Login</title>
  </head>
  <body>
    <header>
      <h1>æ‰“åˆ»</h1>
        <nav>
            <ul>
                <? var current_user_id = getActiveUserId() ?> <!-- user_idã®å–å¾— -->
                <li><a href ="<?= getAppUrl() ?>?page=view_employeeHome&user_id=<?= current_user_id ?>">æ‰“åˆ»</a></li>
                <li><a>é€£çµ¡ãƒ»ç›¸è«‡</a></li>
                <li><a href="<?= getAppUrl() ?>?page=view_login&user_id=<?= current_user_id ?>">ãƒ­ã‚°ã‚¢ã‚¦ãƒˆ</a></li>
            </ul>
        </nav>
    </header>
    <div class="login-message">
      <? var user_id = getActiveUserId() ?> <!-- user_idã®å–å¾— -->
      <? var company_name = getUserInfo(user_id, "company_name") ?> <!-- company_nameã®å–å¾— -->
      <? var user_name = getUserInfo(user_id, "user_name") ?> <!-- user_nameã®å–å¾— -->
      <?= company_name ?>
      ã®
      <?= user_name ?>
      ã•ã‚“ã€ã“ã‚“ã«ã¡ã¯ï¼
    </div>

    <!-- å¿…è¦ãªãƒœã‚¿ãƒ³ã¨ç¾åœ¨ã®çŠ¶æ…‹ã‚’è¡¨ç¤º -->
    <div class="btn-frame">
    <? var condition = getCondition(user_id) ?>
    <? if(condition == "offDuty"){ ?>
      <div>ãŠã‚„ã™ã¿ä¸­ğŸ•Šï¸<div>
      <button id="clock_in">å‡ºå‹¤</button><br>      
      <script>
        var user_id = <?= getActiveUserId() ?>;
        user_id = parseInt(user_id, 10); // æ–‡å­—åˆ—ã¨ã—ã¦å—ã‘å–ã£ãŸã‹ã‚‚ã—ã‚Œãªã„æƒ…å ±ã‚’æ•°å€¤ã«å¤‰æ›ï¼ˆ10é€²æ•°ï¼‰
        document.getElementById("clock_in").addEventListener("click", function(){
          google.script.run.updateCondition(user_id, "clock_in");
          google.script.run.updateTimeCards(user_id, "clock_in");
          // ãƒœã‚¿ãƒ³æŠ¼ã—ãŸæ™‚ã®è‡ªå‹•æ›´æ–°æ©Ÿèƒ½ã¤ã‘ãŸã„ã‘ã©ã†ã¾ãã„ã‹ãªã„
          // console.log("å¾…ã¤ã‚ˆ~");
          // google.script.run.waitSeconds(parseInt(3, 10));
          // console.log("å¾…ã£ãŸã‚ˆ");
          // console.log("ãƒªãƒ­ãƒ¼ãƒ‰ã™ã‚‹ã‚ˆ");
          google.script.run.reloadPage();
        });
      </script>
    <? } ?>
    <? if(condition == "onDuty"){ ?>      
      <div>å‹¤å‹™ä¸­ï¼!</div>
      <button id="break_begin">ä¼‘æ†©é–‹å§‹</button>
      <button id="clock_out">é€€å‹¤</button><br>
      <script>
        var user_id = <?= getActiveUserId() ?>;
        user_id = parseInt(user_id, 10); // æ–‡å­—åˆ—ã¨ã—ã¦å—ã‘å–ã£ãŸã‹ã‚‚ã—ã‚Œãªã„æƒ…å ±ã‚’æ•°å€¤ã«å¤‰æ›ï¼ˆ10é€²æ•°ï¼‰
        document.getElementById("break_begin").addEventListener("click", function(){
          google.script.run.updateCondition(user_id, "break_begin");
          google.script.run.updateTimeCards(user_id, "break_begin");
        });
        document.getElementById("clock_out").addEventListener("click", function(){
          google.script.run.updateCondition(user_id, "clock_out");
          google.script.run.updateTimeCards(user_id, "clock_out");
        });   
      </script>     
    <? } ?>
    <? if(condition == "onBreak"){ ?>
      <div>ä¼‘æ†©ä¸­â˜•ï¸</div>
      <button id="break_end">ä¼‘æ†©çµ‚äº†</button><br>
      <script>
        var user_id = <?= getActiveUserId() ?>;
        user_id = parseInt(user_id, 10); // æ–‡å­—åˆ—ã¨ã—ã¦å—ã‘å–ã£ãŸã‹ã‚‚ã—ã‚Œãªã„æƒ…å ±ã‚’æ•°å€¤ã«å¤‰æ›ï¼ˆ10é€²æ•°ï¼‰
        document.getElementById("break_end").addEventListener("click", function(){
          google.script.run.updateCondition(user_id, "break_end");
          google.script.run.updateTimeCards(user_id, "break_end");
        });
      </script>
    <? } ?>
    <br>
    </div>

    <!-- ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ã¨ã®ä¼šè©±ã‚’è¡¨ç¤º -->
    <div class='image-and-text'>
    <div class='arrow_box'><?= randomTextFromCharacter() ?></div><br>
    <!-- ç”»åƒ -->
    <img src="https://drive.google.com/uc?id=1C_Oe7R0ij1sJOoahfnsLI3fjuIsd5ce1" width="30" height="30" alt="ãŒãã†">  
    </div>  

  </body>
</html>
